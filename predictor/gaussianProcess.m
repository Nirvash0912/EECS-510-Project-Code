n = 366;
rng(1) % For reproducibility
x = linspace(1,n, 366)';
y = [238
236
435
277
313
343
300
353
244
245
276
276
230
283
284
229
207
301
323
289
281
279
200
256
288
290
356
297
238
224
219
311
398
316
295
288
213
242
315
369
338
318
273
244
235
317
418
465
353
338
305
320
404
396
375
395
382
262
316
348
366
327
378
395
274
287
400
374
366
372
311
252
269
292
310
323
309
341
256
229
298
325
299
251
235
218
220
273
294
285
269
252
196
198
237
250
261
269
197
200
185
262
235
219
220
166
151
133
195
212
205
534
203
153
156
195
240
247
237
175
157
160
177
218
178
148
151
181
121
161
212
300
175
158
251
135
159
155
154
147
134
101
108
155
178
172
164
140
323
145
131
172
200
163
137
101
117
149
182
140
131
123
130
114
74
143
141
151
110
94
119
126
129
128
123
107
97
123
143
131
161
126
124
97
117
100
116
120
102
132
107
95
114
112
114
114
112
106
121
128
107
129
112
101
107
88
105
125
112
114
109
97
117
135
116
132
119
117
113
129
129
118
114
130
134
114
109
137
134
128
121
147
95
120
125
252
155
203
161
109
125
171
168
155
169
169
129
134
169
232
176
220
167
163
222
300
223
265
205
188
175
186
248
261
322
213
242
170
185
341
265
303
279
269
179
195
308
290
372
347
315
202
248
300
360
345
310
277
239
256
306
325
359
330
286
208
204
362
340
370
317
261
199
209
260
305
377
309
236
189
211
306
319
287
266
227
198
208
264
268
341
337
239
214
213
269
314
232
205
206
175
242
268
270
275
259
278
220
194
339
343
361
292
252
212
223
282
294
303
288
277
242
239
321
315
309
299
412
236
227
340
366
389
402
397
237
];
%y = sin(10*pi.*x) ./ (2.*x)+(x-1).^4 + 1.5*rand(n,1);
gprMdl = fitrgp(x,y,'KernelFunction','ardmatern32',...
'ActiveSetSize',100,'FitMethod','sr','PredictMethod','fic');
[ypred,~,yci] = predict(gprMdl,x);

plot(x,y,'b');
hold on
plot(x,ypred);
plot(x,yci(:,1),'k--');
plot(x,yci(:,2),'k--');
xlabel('x');
ylabel('y');
legend('Actual response','GPR predictions',...
'95% lower','95% upper','Location','Best');
hold off